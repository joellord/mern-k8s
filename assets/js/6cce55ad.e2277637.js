"use strict";(self.webpackChunkmdbw_atlas_operator=self.webpackChunkmdbw_atlas_operator||[]).push([[9949],{3905:function(e,n,t){t.d(n,{Zo:function(){return l},kt:function(){return m}});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var u=r.createContext({}),s=function(e){var n=r.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},l=function(e){var n=s(e.components);return r.createElement(u.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,u=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),d=s(t),m=o,f=d["".concat(u,".").concat(m)]||d[m]||p[m]||a;return t?r.createElement(f,c(c({ref:n},l),{},{components:t})):r.createElement(f,c({ref:n},l))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,c=new Array(a);c[0]=d;var i={};for(var u in n)hasOwnProperty.call(n,u)&&(i[u]=n[u]);i.originalType=e,i.mdxType="string"==typeof e?e:o,c[1]=i;for(var s=2;s<a;s++)c[s]=t[s];return r.createElement.apply(null,c)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},1873:function(e,n,t){t.r(n),t.d(n,{assets:function(){return l},contentTitle:function(){return u},default:function(){return m},frontMatter:function(){return i},metadata:function(){return s},toc:function(){return p}});var r=t(7462),o=t(3366),a=(t(7294),t(3905)),c=["components"],i={sidebar_position:5},u="Configure the backend",s={unversionedId:"introducing-atlas-operator/configure-backend",id:"introducing-atlas-operator/configure-backend",title:"Configure the backend",description:"Now that your project and cluster are created, you can access the various properties from your Atlas instance. You can now access the connection string, and even configure your backend service to use that connection string.",source:"@site/docs/introducing-atlas-operator/5-configure-backend.md",sourceDirName:"introducing-atlas-operator",slug:"/introducing-atlas-operator/configure-backend",permalink:"/mern-k8s/docs/introducing-atlas-operator/configure-backend",draft:!1,editUrl:"https://github.com/joellord/mern-k8s/tree/main/docs/docs/introducing-atlas-operator/5-configure-backend.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Create and manage an Atlas deployment",permalink:"/mern-k8s/docs/introducing-atlas-operator/manage-atlas"},next:{title:"Summary",permalink:"/mern-k8s/docs/conclusion"}},l={},p=[{value:"Get the connection string",id:"get-the-connection-string",level:2},{value:"Update the backend deployment",id:"update-the-backend-deployment",level:2}],d={toc:p};function m(e){var n=e.components,t=(0,o.Z)(e,c);return(0,a.kt)("wrapper",(0,r.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"configure-the-backend"},"Configure the backend"),(0,a.kt)("p",null,"Now that your project and cluster are created, you can access the various properties from your Atlas instance. You can now access the connection string, and even configure your backend service to use that connection string."),(0,a.kt)("h2",{id:"get-the-connection-string"},"Get the connection string"),(0,a.kt)("p",null,"You can see the connection strings for your newly created cluster by using the following command."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl get secret mern-k8s-cluster0-mernk8s -o json | jq -r '.data | with_entries(.value |= @base64d)'\n")),(0,a.kt)("h2",{id:"update-the-backend-deployment"},"Update the backend deployment"),(0,a.kt)("p",null,"Now that you can find your connection string from within Kubernetes, you can use that as part of your deployment to specify the connection string to your backend. "),(0,a.kt)("p",null,"In your ",(0,a.kt)("inlineCode",{parentName:"p"},"/back/deployment.yaml")," file, change the ",(0,a.kt)("inlineCode",{parentName:"p"},"env")," section of the containers template to the following."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'          env: \n            - name: PORT\n              value: "5000"\n            - name: "CONN_STR"\n              valueFrom:\n                secretKeyRef:\n                  name: mern-k8s-cluster0-mernk8s\n                  key: connectionStringStandardSrv\n')),(0,a.kt)("p",null,"This will use the same connection string you've just seen in your terminal."),(0,a.kt)("p",null,"Apply those changes to your cluster."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl apply -f ./back\n")),(0,a.kt)("p",null,"If you look at your current pods:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl get pods\n")),(0,a.kt)("p",null,"You should see that your backend pods have been restarted. Opening the application in the browser again should now be using this newly created cluster."))}m.isMDXComponent=!0}}]);